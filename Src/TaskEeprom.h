#ifndef TASK_EEPROM_H
#define TASK_EEPROM_H

#include <stdint.h>
#include <stdbool.h>
#include "Eeprom.h"

#define EEPROM_VIRTUAL_ADDR_BEGIN   0   
#define MAX_EEPROM_ADDRESS        255

typedef uint32_t EEPROM_DATA;

typedef enum
{
    ENABLE_MEASURE_ADDR    = EEPROM_VIRTUAL_ADDR_BEGIN,
    VOLTAGE_MEASURE_ADDR,
    ADC_OFFSET_ADDR,   
    SOGLIE_ALLARMI_IO_ADDR, 
    SOGLIE_ALLARMI_IU_ADDR =  SOGLIE_ALLARMI_IO_ADDR + STR_SIZE,
    SOGLIE_ALLARMI_PO_ADDR =  SOGLIE_ALLARMI_IU_ADDR + STR_SIZE,
    SOGLIE_ALLARMI_PU_ADDR =  SOGLIE_ALLARMI_PO_ADDR + STR_SIZE,
    SOGLIE_ALLARMI_EO_ADDR =  SOGLIE_ALLARMI_PU_ADDR + STR_SIZE,
    SOGLIE_ALLARMI_EU_ADDR =  SOGLIE_ALLARMI_EO_ADDR + STR_SIZE,
    ENERGIA_ADDR           =  SOGLIE_ALLARMI_EU_ADDR + STR_SIZE,
    LOG_ENERGY_ADDR = 66,
    ENABLE_SCREENSAVER_ADDR,
    SCREENSAVER_TYPE_ADDR,
    LED_CONF_ADDR,
    SCREEN_SAVER_TIMER_ADDR ,
    ENABLE_SIMULATION_ADDR ,
    FREQUENCY_SIM_ADDR ,
    ADDR_73 ,
    ADDR_74 ,
    ADDR_75 ,
    ADDR_76 ,
    ADDR_77 ,
    ADDR_78 ,
    ADDR_79 ,
    ADDR_80 ,
    ADDR_81 ,
    ADDR_82 ,
    ADDR_83 ,
    ADDR_84 ,
    ADDR_85 ,
    ADDR_86 ,
    ADDR_87 ,
    ADDR_88 ,
    ADDR_89 ,
    ADDR_90 ,
    ADDR_91 ,
    ADDR_92 ,
    ADDR_93 ,
    ADDR_94 ,
    ADDR_95 ,
    ADDR_96 ,
    ADDR_97 ,
    ADDR_98 ,
    ADDR_99 ,
    ADDR_100,
    ADDR_101,
    ADDR_102,
    ADDR_103,
    ADDR_104,
    ADDR_105,
    ADDR_106,
    ADDR_107,
    ADDR_108,
    ADDR_109,
    ADDR_110,
    ADDR_111,
    ADDR_112,
    ADDR_113,
    ADDR_114,
    ADDR_115,
    ADDR_116,
    ADDR_117,
    ADDR_118,
    ADDR_119,
    ADDR_120,
    ADDR_121,
    ADDR_122,
    ADDR_123,
    ADDR_124,
    ADDR_125,
    ADDR_126,
    ADDR_127,
    ADDR_128,
    ADDR_129,
    ADDR_130,
    ADDR_131,
    ADDR_132,
    ADDR_133,
    ADDR_134,
    ADDR_135,
    ADDR_136,
    ADDR_137,
    ADDR_138,
    ADDR_139,
    ADDR_140,
    ADDR_141,
    ADDR_142,
    ADDR_143,
    ADDR_144,
    ADDR_145,
    ADDR_146,
    ADDR_147,
    ADDR_148,
    ADDR_149,    // FINE BLOCCO PARAMETRI
    ADDR_150,    // INIZIO SALVATAGGIO VALORI (posso salvare 11 float)
    ADDR_151,    
    ADDR_152,
    ADDR_153,
    ADDR_154,
    ADDR_155,
    ADDR_156,
    ADDR_157,
    ADDR_158,
    ADDR_159,
    ADDR_160,
    ADDR_161,
    ADDR_162,
    ADDR_163,
    ADDR_164,
    ADDR_165,
    ADDR_166,
    ADDR_167,
    ADDR_168,
    ADDR_169,
    ADDR_170,
    ADDR_171,
    ADDR_172,
    ADDR_173,
    ADDR_174,
    ADDR_175,
    ADDR_176,
    ADDR_177,
    ADDR_178,
    ADDR_179,
    ADDR_180,
    ADDR_181,
    ADDR_182,
    ADDR_183,
    ADDR_184,
    ADDR_185,
    ADDR_186,
    ADDR_187,
    ADDR_188,
    ADDR_189,
    ADDR_190,
    ADDR_191,
    ADDR_192,
    ADDR_193,
    ADDR_194,
    ADDR_195,
    ADDR_196,
    ADDR_197,
    ADDR_198,
    ADDR_199,
    ADDR_200,
    ADDR_201,
    ADDR_202,
    ADDR_203,
    ADDR_204,
    ADDR_205,
    ADDR_206,
    ADDR_207,
    ADDR_208,
    ADDR_209,
    ADDR_210,
    ADDR_211,
    ADDR_212,
    ADDR_213,
    ADDR_214,
    ADDR_215,
    ADDR_216,
    ADDR_217,
    ADDR_218,
    ADDR_219,
    ADDR_220,
    ADDR_221,
    ADDR_222,
    ADDR_223,
    ADDR_224,
    ADDR_225,
    ADDR_226,
    ADDR_227,
    ADDR_228,
    ADDR_229,
    ADDR_230,
    ADDR_231,
    ADDR_232,
    ADDR_233,
    ADDR_234,
    ADDR_235,
    ADDR_236,
    ADDR_237,
    ADDR_238,
    ADDR_239,
    ADDR_240,
    ADDR_241,
    ADDR_242,
    ADDR_243,
    ADDR_244,
    ADDR_245,
    ADDR_246,
    ADDR_247,
    ADDR_248,
    ADDR_249,   // FINE SALVATAGGIO VALORI
    ADDR_250, 
    
    NUMBER_OF_WRITES_ADDR  =  MAX_EEPROM_ADDRESS     - U_INT32_SIZE, 
}EEPROM_ADDRESS;




enum
{
    CURRENT_THR_FLAG = 0,
    POWER_THR_FLAG      ,
    ENERGY_THR_FLAG
};

typedef struct
{
    bool SaveParameters;
    bool SaveThresholds[3];
    bool SaveEnergy;
    bool EraseAll;
    bool SaveAll;
}FLAG_EEPROM;

extern FLAG_EEPROM EepFlag;
extern EEPROM_DATA EepromSavedValue[];

void TaskEeprom(void const * argument);
#endif